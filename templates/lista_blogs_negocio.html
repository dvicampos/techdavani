<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blogs de {{ negocio['business_name'] }}</title>

  <!-- Bootstrap / Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root{
      --page-bg: #050814;
      --ink: #e2e8f0;
      --muted: #94a3b8;
      --accent: #f3c623;
      --radius: 16px;
    }

    body{
      background: radial-gradient(circle at 8% -10%, rgba(243,198,35,.16), rgba(5,8,20,0) 45%), var(--page-bg);
      min-height: 100vh;
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      color: var(--ink);
    }

    /* navbar neutro */
    .navbar-post{
      background: rgba(6,8,14,.25);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(148,163,184,.12);
    }

    /* contenedor principal */
    .blogs-shell{
      max-width: 1100px;
      margin: 90px auto 70px;
      padding: 0 1rem;
    }

    .section-heading{
      text-align: center;
      margin-bottom: 1.5rem;
    }
    .section-heading h1{
      font-weight: 700;
      font-size: clamp(1.4rem, 3.2vw, 1.8rem);
      color: #fff;
    }
    .section-heading p{
      color: rgba(226,232,240,.55);
      font-size: .8rem;
    }

    /* volver */
    .back-wrap{
      text-align: center;
      margin-bottom: 1rem;
    }
    .btn-back{
      border: 1px solid rgba(226,232,240,.4);
      color: #fff;
      border-radius: 999px;
      font-size: .75rem;
    }
    .btn-back:hover{background: rgba(226,232,240,.08);}

    /* ===== buscador CON marco animado ===== */
    .search-wrap{
      display: flex;
      justify-content: center;
      margin-bottom: 1.6rem;
    }

    .search-box{
      position: relative;
      width: min(95%, 500px);
      border-radius: 18px;
      overflow: hidden;
    }

    /* borde animado */
    .search-box::before{
      content: "";
      position: absolute;
      inset: -120% -50%;
      background: conic-gradient(from 120deg,
                rgba(243,198,35,0) 0deg,
                rgba(243,198,35,.6) 90deg,
                rgba(37,99,235,.6) 180deg,
                rgba(243,198,35,0) 270deg,
                rgba(243,198,35,0) 360deg);
      animation: spin 4s linear infinite;
      z-index: 0;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .search-inner{
      position: relative;
      z-index: 1;
      background: rgba(11,15,25,.85);
      backdrop-filter: blur(14px);
      border: 1px solid rgba(148,163,184,.25);
      border-radius: 16px;
      padding: .4rem .4rem .45rem .7rem;
      display: flex;
      gap: .4rem;
      align-items: center;
    }

    .search-icon{
      width: 32px;
      height: 32px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: rgba(243,198,35,.13);
      color: #fff;
      flex: 0 0 32px;
    }

    .search-input{
      background: transparent;
      border: 0;
      outline: 0;
      color: #fff;
      font-size: .78rem;
      flex: 1 1 auto;
      min-width: 0;
    }

    .search-input::placeholder{
      color: rgba(226,232,240,.45);
    }

    .search-btn{
      border-radius: 999px;
      font-size: .7rem;
      padding: .25rem .75rem;
      white-space: nowrap;
    }

    .search-clear{
      border-radius: 999px;
      font-size: .7rem;
      padding: .25rem .5rem;
      white-space: nowrap;
    }

    /* lista de posts */
    .post-list{
      display: flex;
      flex-direction: column;
      gap: .7rem;
      margin-bottom: 1.5rem;
    }
    .post-item{
      display: block;
      background: rgba(12,16,27,.45);
      border: 1px solid rgba(148,163,184,.12);
      border-radius: 14px;
      padding: .85rem 1rem .9rem;
      text-decoration: none;
      transition: transform .12s ease, box-shadow .12s ease, border .12s ease;
    }
    .post-item:hover{
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
      border: 1px solid rgba(226,232,240,.28);
    }

    .post-title{
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      margin-bottom: .25rem;
    }
    .post-excerpt{
      font-size: .7rem;
      color: rgba(226,232,240,.6);
      margin-bottom: .35rem;
    }
    .post-meta{
      font-size: .65rem;
      color: rgba(226,232,240,.45);
      display: flex;
      gap: .6rem;
      align-items: center;
      flex-wrap: wrap;
    }
    .pill-small{
      background: rgba(243,198,35,.14);
      border: 1px solid rgba(243,198,35,.3);
      border-radius: 999px;
      padding: .1rem .5rem .15rem;
      font-size: .6rem;
      color: #fde68a;
      text-transform: uppercase;
      letter-spacing: .04em;
    }

    /* paginación */
    .pagination .page-link{
      background: rgba(15,23,42,.35);
      border: 1px solid rgba(148,163,184,.25);
      color: #fff;
    }
    .pagination .page-item.active .page-link{
      background: #2563eb;
      border-color: #2563eb;
    }

    /* footer neutro */
    footer{
      background: rgba(2,6,23,.2);
      border-top: 1px solid rgba(148,163,184,.1);
      color: rgba(226,232,240,.5);
      padding: 1.4rem 0 1.2rem;
      text-align:center;
      font-size:.7rem;
    }
    footer a{color: rgba(226,232,240,.8);}
    footer a:hover{color: #fff;}

    /* ====== Responsive ====== */
    @media (max-width: 768px){
      .blogs-shell{margin-top: 80px;}
      .search-box{width: 100%;}
      .search-inner{gap: .35rem; flex-wrap: wrap;}
      .search-input{flex-basis: 100%;}
      .search-btn,
      .search-clear{width: auto;}
      .post-item{padding: .8rem .7rem .8rem;}
      .post-title{font-size: .9rem;}
      .search-icon{display: none;}
    }
  </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#mainNavbar" data-bs-offset="80" tabindex="0">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top navbar-post">
  <div class="container">
    <a class="navbar-brand fw-bold" href="{{ url_for('detalle_negocio', nombre=negocio['business_name']) }}">
      {{ negocio['business_name'] }}
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>
</nav>

<!-- Contenido -->
<div class="blogs-shell">

  <div class="section-heading">
    <h1>Blogs del negocio</h1>
    <p>Contenido publicado en {{ negocio['business_name'] }}. Vista neutra para todas las temáticas.</p>
  </div>

  {% if negocio %}
  <div class="back-wrap">
    <a href="{{ url_for('detalle_negocio', nombre=negocio['business_name']) }}" class="btn btn-back">
      <i class="bi bi-arrow-left-circle"></i> Volver a {{ negocio['business_name'] }}
    </a>
  </div>
  {% endif %}

  <!-- Buscador -->
  <div class="search-wrap">
    <div class="search-box">
      <form method="get" action="{{ url_for('lista_blogs_negocio', nombre=negocio['business_name']) }}">
        <div class="search-inner">
          <span class="search-icon"><i class="bi bi-search"></i></span>
          <input class="search-input" type="text" name="search" placeholder="Buscar en los blogs..." value="{{ query or '' }}">
          <button type="submit" class="btn btn-primary btn-sm search-btn">Buscar</button>
          {% if query %}
            <a href="{{ url_for('lista_blogs_negocio', nombre=negocio['business_name'], page=1) }}"
               class="btn btn-outline-light btn-sm search-clear">
              <i class="bi bi-x-lg"></i>
            </a>
          {% endif %}
        </div>
      </form>
    </div>
  </div>

  <!-- Listado -->
  <div class="post-list">
    {% for post in posts %}
      <a href="{{ url_for('ver_post', post_id=post['_id']) }}" class="post-item">
        <div class="post-title">
          {{ post['title'] or 'Publicación sin título' }}
        </div>
        <div class="post-excerpt">
          {% if post['content'] %}
            {{ post['content'][:150] }}{% if post['content']|length > 150 %}…{% endif %}
          {% else %}
            Publicación sin contenido.
          {% endif %}
        </div>
        <div class="post-meta">
          <span><i class="bi bi-calendar-event me-1"></i>
            {% if post.get('date') %}
              {{ post['date'].strftime('%d/%m/%Y') }}
            {% else %}
              Sin fecha
            {% endif %}
          </span>
          <span class="pill-small">blog</span>
        </div>
      </a>
    {% else %}
      <p class="text-center text-muted mt-3 mb-4">No se encontraron posts para este negocio.</p>
    {% endfor %}
  </div>

  <!-- Paginación -->
  <nav aria-label="Página de navegación">
    <ul class="pagination justify-content-center mt-4">
      <li class="page-item {% if page == 1 %}disabled{% endif %}">
        <a class="page-link"
           href="{{ url_for('lista_blogs_negocio', nombre=negocio['business_name'], page=page-1, search=query) }}">Anterior</a>
      </li>
      {% for p in range(1, total_posts // per_page + 2) %}
        <li class="page-item {% if p == page %}active{% endif %}">
          <a class="page-link"
             href="{{ url_for('lista_blogs_negocio', nombre=negocio['business_name'], page=p, search=query) }}">{{ p }}</a>
        </li>
      {% endfor %}
      <li class="page-item {% if page * per_page >= total_posts %}disabled{% endif %}">
        <a class="page-link"
           href="{{ url_for('lista_blogs_negocio', nombre=negocio['business_name'], page=page+1, search=query) }}">Siguiente</a>
      </li>
    </ul>
  </nav>

</div>

<!-- Footer neutro -->
<footer>
  <div class="container">
    <p class="mb-1">&copy; 2025 <strong>{{ negocio['business_name'] }}</strong> · Blogs</p>
    <small>Creado por <a href="https://davanitechnology.com/" target="_blank" rel="noopener">DavaniTechnology</a></small>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
